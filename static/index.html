<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USF RAG</title>
    <link rel="stylesheet" href="/static/style.css?v=20">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <div class="logo">
                <div class="logo-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L2 7L12 12L22 7L12 2Z"/>
                        <path d="M2 17L12 22L22 17"/>
                        <path d="M2 12L12 17L22 12"/>
                    </svg>
                </div>
                <span class="logo-text">USF RAG</span>
            </div>
        </div>
        <div class="header-right">
            <div class="welcome-section">
                <span class="welcome-text">Welcome back,</span>
                <span class="user-name" id="header-user-name">user 1</span>
            </div>
        </div>
    </header>

    <div class="app-wrapper">
        <!-- Sidebar -->
        <aside class="sidebar">
            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-page="overview">
                    <span class="nav-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="7" height="7"/>
                            <rect x="14" y="3" width="7" height="7"/>
                            <rect x="14" y="14" width="7" height="7"/>
                            <rect x="3" y="14" width="7" height="7"/>
                        </svg>
                    </span>
                    <span class="nav-text">Overview</span>
                </a>
                <a href="#" class="nav-item" data-page="chat">
                    <span class="nav-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                        </svg>
                    </span>
                    <span class="nav-text">Chat</span>
                </a>
                <a href="#" class="nav-item" data-page="documents">
                    <span class="nav-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <polyline points="14 2 14 8 20 8"/>
                        </svg>
                    </span>
                    <span class="nav-text">Documents</span>
                </a>
            </nav>

            <div class="sidebar-footer">
                <div class="user-profile">
                    <div class="user-avatar">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                            <circle cx="12" cy="7" r="4"/>
                        </svg>
                    </div>
                    <div class="user-info">
                        <span class="profile-name user-name">RAG User</span>
                        <span class="profile-email user-email">user@rag.ai</span>
                    </div>
                </div>
                <button class="logout-btn" onclick="logout()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                        <polyline points="16 17 21 12 16 7"/>
                        <line x1="21" y1="12" x2="9" y2="12"/>
                    </svg>
                    Logout
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Page: Overview -->
            <div class="page active" id="page-overview">
                <!-- Hero Section -->
                <section class="hero-section">
                    <div class="hero-content">
                        <div class="hero-badge">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
                            </svg>
                            AI-POWERED RAG SYSTEM
                        </div>
                        <h1 class="hero-title">
                            <span class="title-highlight">RAG Document Assistant</span>
                            <span class="title-normal"> - Smart Document Q&A</span>
                        </h1>
                        <p class="hero-description">
                            Transform how you interact with documents using AI. Upload your files, 
                            ask questions in natural language, and get accurate answers with source 
                            citations - powered by advanced retrieval-augmented generation technology.
                        </p>
                    </div>
                    <div class="hero-decoration"></div>
                </section>

                <!-- Features Section -->
                <section class="features-section">
                    <div class="section-header">
                        <h2 class="section-title">RAG Assistant <span class="title-bold">Features</span></h2>
                        <p class="section-subtitle">Comprehensive AI-powered tools for intelligent document interaction</p>
                    </div>

                    <div class="features-grid">
                        <div class="feature-card" data-page="chat">
                            <div class="feature-icon blue">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                                </svg>
                            </div>
                            <div class="feature-content">
                                <h3 class="feature-title">Chat with Documents</h3>
                                <p class="feature-description">Ask questions in natural language and get AI-powered answers from your uploaded documents instantly.</p>
                            </div>
                        </div>

                        <label class="feature-card" for="file-input">
                            <div class="feature-icon green">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                    <polyline points="17 8 12 3 7 8"/>
                                    <line x1="12" y1="3" x2="12" y2="15"/>
                                </svg>
                            </div>
                            <div class="feature-content">
                                <h3 class="feature-title">Document Upload</h3>
                                <p class="feature-description">Upload multiple files at once - supports PDF, TXT, and Markdown files with automatic processing.</p>
                            </div>
                            <input type="file" id="file-input" accept=".txt,.pdf,.md" multiple hidden>
                        </label>

                        <div class="feature-card" data-page="documents">
                            <div class="feature-icon purple">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="11" cy="11" r="8"/>
                                    <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                                </svg>
                            </div>
                            <div class="feature-content">
                                <h3 class="feature-title">Semantic Search</h3>
                                <p class="feature-description">Advanced vector search finds relevant information based on meaning, not just keywords.</p>
                            </div>
                        </div>

                        <div class="feature-card">
                            <div class="feature-icon orange">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                                    <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                                </svg>
                            </div>
                            <div class="feature-content">
                                <h3 class="feature-title">Source Citations</h3>
                                <p class="feature-description">Every answer includes references to source documents so you can verify the information.</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Stats Section -->
                <section class="stats-section">
                    <div class="stat-card">
                        <div class="stat-value" id="stat-docs">0</div>
                        <div class="stat-label">Documents</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-chunks">0</div>
                        <div class="stat-label">Knowledge Chunks</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">Active</div>
                        <div class="stat-label">AI Status</div>
                    </div>
                </section>
            </div>

            <!-- Page: Chat -->
            <div class="page" id="page-chat">
                <div class="chat-header">
                    <h2 class="page-title">Chat with Documents</h2>
                    <div class="chat-header-actions">
                        <button class="btn-secondary" onclick="shareChat()" title="Share Chat">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="18" cy="5" r="3"></circle>
                                <circle cx="6" cy="12" r="3"></circle>
                                <circle cx="18" cy="19" r="3"></circle>
                                <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                                <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                            </svg>
                            Share
                        </button>
                        <button class="btn-secondary" id="clear-chat">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="3 6 5 6 21 6"/>
                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                            </svg>
                            Clear Chat
                        </button>
                    </div>
                </div>

                <div class="chat-container">
                    <div class="chat-messages" id="chat-messages">
                        <div class="message assistant" id="welcome-message">
                            <div class="message-avatar">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 2L2 7L12 12L22 7L12 2Z"/>
                                    <path d="M2 17L12 22L22 17"/>
                                    <path d="M2 12L12 17L22 12"/>
                                </svg>
                            </div>
                            <div class="message-content" id="welcome-message-content">
                                <p>üîÆ I read documents so you don't have to. Upload your files and watch the magic happen.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Uploaded Files Preview Bar -->
                    <div class="chat-files-bar hidden" id="chat-files-bar">
                        <div class="chat-files-list" id="chat-files-list"></div>
                    </div>

                    <div class="chat-input-area">
                        <input type="text" class="chat-input" placeholder="Ask a question about your documents..." id="question-input">
                        <button class="web-search-btn" id="web-search-toggle" title="Toggle web search">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <line x1="2" y1="12" x2="22" y2="12"/>
                                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
                            </svg>
                        </button>
                        <label class="attach-btn" for="chat-file-input" title="Upload document">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"/>
                                <line x1="5" y1="12" x2="19" y2="12"/>
                            </svg>
                            <input type="file" id="chat-file-input" accept=".txt,.pdf,.md,.docx,.xlsx,.csv,.png,.jpg,.jpeg,.gif,.bmp,.webp" multiple hidden>
                        </label>
                        <button class="send-btn" id="send-button">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="22" y1="2" x2="11" y2="13"/>
                                <polygon points="22 2 15 22 11 13 2 9 22 2"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Page: Documents -->
            <div class="page" id="page-documents">
                <div class="page-header">
                    <h2 class="page-title">Your Documents</h2>
                    <div class="page-header-actions">
                        <button class="btn-danger" id="delete-all-docs" title="Delete All Documents">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="3 6 5 6 21 6"/>
                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                            </svg>
                            Delete All
                        </button>
                        <label class="btn-primary upload-dropzone" for="file-input-docs" id="upload-area">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                <polyline points="17 8 12 3 7 8"/>
                                <line x1="12" y1="3" x2="12" y2="15"/>
                            </svg>
                            Upload Files
                            <input type="file" id="file-input-docs" accept=".txt,.pdf,.md,.docx,.xlsx,.csv,.png,.jpg,.jpeg,.gif,.bmp,.webp" multiple hidden>
                        </label>
                    </div>
                </div>

                <!-- Upload Progress -->
                <div id="upload-progress-container" class="upload-progress-container hidden"></div>

                <!-- Documents List -->
                <div class="documents-section">
                    <h3 class="documents-count">Documents (<span id="doc-count">0</span>)</h3>
                    <div class="documents-list" id="document-list">
                        <div class="empty-state" id="empty-state">
                            <div class="empty-icon">üìÅ</div>
                            <h3 class="empty-title">No documents uploaded yet</h3>
                            <p class="empty-text">Upload your first document to get started</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Page: Settings -->
            <div class="page" id="page-settings">
                <h2 class="page-title">Settings</h2>

                <div class="settings-card">
                    <h3 class="settings-title">System Information</h3>
                    <div class="settings-item">
                        <span class="settings-label">Documents Indexed</span>
                        <span class="settings-value" id="settings-docs">0</span>
                    </div>
                    <div class="settings-item">
                        <span class="settings-label">Knowledge Chunks</span>
                        <span class="settings-value" id="settings-chunks">0</span>
                    </div>
                    <div class="settings-item">
                        <span class="settings-label">AI Model</span>
                        <span class="settings-value">USF Model</span>
                    </div>
                </div>

                <div class="settings-card danger">
                    <h3 class="settings-title">Danger Zone</h3>
                    <p class="settings-description">These actions are irreversible. Please proceed with caution.</p>
                    <button class="btn-danger" id="delete-all">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="3 6 5 6 21 6"/>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                        </svg>
                        Delete All Documents
                    </button>
                </div>
            </div>

            <!-- Page: Admin -->
            <div class="page" id="page-admin">
                <div class="page-header">
                    <h2 class="page-title">Admin Dashboard</h2>
                    <button class="btn-secondary" id="admin-refresh">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M23 4v6h-6"/>
                            <path d="M1 20v-6h6"/>
                            <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
                        </svg>
                        Refresh
                    </button>
                </div>

                <!-- Stats Cards -->
                <div class="admin-stats-grid">
                    <div class="admin-stat-card">
                        <div class="admin-stat-icon docs">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                <polyline points="14 2 14 8 20 8"/>
                            </svg>
                        </div>
                        <div class="admin-stat-info">
                            <span class="admin-stat-value" id="admin-docs-count">0</span>
                            <span class="admin-stat-label">Documents</span>
                        </div>
                    </div>
                    <div class="admin-stat-card">
                        <div class="admin-stat-icon chunks">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="3" width="7" height="7"/>
                                <rect x="14" y="3" width="7" height="7"/>
                                <rect x="14" y="14" width="7" height="7"/>
                                <rect x="3" y="14" width="7" height="7"/>
                            </svg>
                        </div>
                        <div class="admin-stat-info">
                            <span class="admin-stat-value" id="admin-chunks-count">0</span>
                            <span class="admin-stat-label">Chunks</span>
                        </div>
                    </div>
                    <div class="admin-stat-card">
                        <div class="admin-stat-icon messages">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                            </svg>
                        </div>
                        <div class="admin-stat-info">
                            <span class="admin-stat-value" id="admin-messages-count">0</span>
                            <span class="admin-stat-label">Messages</span>
                        </div>
                    </div>
                    <div class="admin-stat-card">
                        <div class="admin-stat-icon storage">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <ellipse cx="12" cy="5" rx="9" ry="3"/>
                                <path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/>
                                <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/>
                            </svg>
                        </div>
                        <div class="admin-stat-info">
                            <span class="admin-stat-value" id="admin-storage-size">0 MB</span>
                            <span class="admin-stat-label">Storage</span>
                        </div>
                    </div>
                </div>

                <!-- Database Health -->
                <div class="admin-section">
                    <h3 class="admin-section-title">Database Health</h3>
                    <div class="admin-health-card" id="admin-health-card">
                        <div class="health-status">
                            <span class="health-indicator healthy" id="health-indicator"></span>
                            <span class="health-text" id="health-status-text">Checking...</span>
                        </div>
                        <div class="health-details">
                            <div class="health-item">
                                <span class="health-label">Vector Store:</span>
                                <span class="health-value" id="health-vector-store">-</span>
                            </div>
                            <div class="health-item">
                                <span class="health-label">Embedding Model:</span>
                                <span class="health-value" id="health-embedding-model">-</span>
                            </div>
                            <div class="health-item">
                                <span class="health-label">Total Chunks:</span>
                                <span class="health-value" id="health-total-chunks">-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Search Chunks -->
                <div class="admin-section">
                    <h3 class="admin-section-title">Search Chunks</h3>
                    <div class="admin-search-bar">
                        <input type="text" class="admin-search-input" id="chunk-search-input" placeholder="Search chunks by keyword...">
                        <button class="btn-primary" id="chunk-search-btn">Search</button>
                    </div>
                    <div class="admin-search-results hidden" id="chunk-search-results">
                        <div class="search-results-header">
                            <span id="search-results-count">0 results</span>
                            <button class="btn-text" id="clear-search-results">Clear</button>
                        </div>
                        <div class="search-results-list" id="search-results-list"></div>
                    </div>
                </div>

                <!-- Documents Table -->
                <div class="admin-section">
                    <h3 class="admin-section-title">Documents</h3>
                    <div class="admin-table-container">
                        <table class="admin-table" id="admin-documents-table">
                            <thead>
                                <tr>
                                    <th>Filename</th>
                                    <th>Type</th>
                                    <th>Size</th>
                                    <th>Chunks</th>
                                    <th>Uploaded</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="admin-documents-tbody">
                                <tr class="loading-row">
                                    <td colspan="6">Loading documents...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Chunk Viewer -->
                <div class="admin-section hidden" id="chunk-viewer-section">
                    <div class="chunk-viewer-header">
                        <h3 class="admin-section-title">Chunks for: <span id="chunk-viewer-filename"></span></h3>
                        <button class="btn-text" id="close-chunk-viewer">Close</button>
                    </div>
                    <div class="chunk-viewer-list" id="chunk-viewer-list"></div>
                </div>

                <!-- Chat History -->
                <div class="admin-section">
                    <div class="admin-section-header">
                        <h3 class="admin-section-title">Chat History</h3>
                        <button class="btn-danger-small" id="clear-chat-history">Clear All</button>
                    </div>
                    <div class="admin-chat-history" id="admin-chat-history">
                        <p class="empty-text">No chat history yet.</p>
                    </div>
                </div>

                <!-- Danger Zone -->
                <div class="admin-section danger-zone">
                    <h3 class="admin-section-title">Danger Zone</h3>
                    <p class="danger-description">These actions are irreversible. Please proceed with caution.</p>
                    <div class="danger-actions">
                        <button class="btn-warning" id="admin-optimize-db">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/>
                            </svg>
                            Optimize Database
                        </button>
                        <button class="btn-danger" id="admin-clear-all">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="3 6 5 6 21 6"/>
                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                            </svg>
                            Clear All Data
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Document Preview Modal -->
    <div class="modal-overlay hidden" id="preview-modal">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title" id="preview-title">Document Preview</h3>
                <div class="modal-tabs">
                    <button class="modal-tab active" id="tab-preview" data-tab="preview">Preview</button>
                    <button class="modal-tab" id="tab-json" data-tab="json">JSON Data</button>
                </div>
                <button class="modal-close" id="preview-close">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="tab-content active" id="content-preview">
                    <pre class="preview-content" id="preview-content"></pre>
                    <iframe class="preview-iframe hidden" id="preview-iframe"></iframe>
                </div>
                <div class="tab-content hidden" id="content-json">
                    <div class="json-loading hidden" id="json-loading">Extracting structured data...</div>
                    <pre class="json-content" id="json-content"></pre>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/app.js?v=36"></script>
</body>
</html>
